<script src="https://marcheprime.github.io/lib/js/aframe.min.js"></script>
<script src="https://marcheprime.github.io/lib/js/aframe-ar.js"></script>

<body style='margin : 0px; overflow: hidden;'>
  <script>
    var markerVisible = { "obj1": false, "obj2": false, "obj3": false, "obj4": false, "obj5": false };
    var markertrouve = { "obj1": false, "obj2": false, "obj3": false, "obj4": false, "obj5": false };
    var jeufini = false;

    AFRAME.registerComponent('registerevents', {
        init: function () 
        {
            let marker = this.el;
            var entity2 = document.querySelector('#s2');
			var entity3 = document.querySelector('#s3');
          
            var mark1 = document.querySelector('#box1');
			
			var mark3fond = document.querySelector('#obj3fondtri');
            var mark3txt = document.querySelector('#obj3txttri');
            
            marker.addEventListener('markerFound', function() {
                markerVisible[ marker.id ] = true;
                //console.log( markerVisible );
                //console.log('DEBUG markertrouve obj1:' + markertrouve['obj1'] + ' | obj2:' + markertrouve['obj2']);
                
				if( markerVisible['obj1'] == true && markertrouve['obj1'] == false){
                  entity2.components.sound.playSound();
                  markertrouve['obj1'] = true;
                }				
				
				if( markerVisible['obj2'] == true && markertrouve['obj2'] == false){
                  entity3.components.sound.playSound();
                }
				if( markerVisible['obj3'] == true && markertrouve['obj3'] == false){
                  entity3.components.sound.playSound();
                }
                if( markerVisible['obj4'] == true && markertrouve['obj4'] == false){
                  entity3.components.sound.playSound();
                }
				if( markerVisible['obj5'] == true && markertrouve['obj5'] == false){
                  entity3.components.sound.playSound();
                }
				
                if( markertrouve['obj1'] && jeufini == false){
                  //entity2.components.sound.playSound();
                  jeufini = true;
                  console.log('[JEU TERMINE !!!]');
                }
                
            });

            marker.addEventListener('markerLost', function() {
                markerVisible[ marker.id ] = false;
                //console.log( markerVisible );
            });
        }
    });
    
    </script>
  
	<a-scene embedded vr-mode-ui="enabled: false;" arjs="debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;">
    <a-assets>
      <a-asset-item id="sound" src="https://marcheprime.github.io/lib/assets/victoire01.wav" response-type="arraybuffer"></a-asset-item>
      <a-asset-item id="sound2" src="https://marcheprime.github.io/lib/assets/victoire02.wav" response-type="arraybuffer"></a-asset-item>
      <a-asset-item id="sound3" src="https://marcheprime.github.io/lib/assets/mauvais.wav" response-type="arraybuffer"></a-asset-item>
    </a-assets>

	<a-marker id='obj1' preset='hiro' registerevents>
		<a-box id='box1' position='1 1 0' material='opacity: 0.5;' visible='true'></a-box>
	</a-marker>
    
    <a-marker id='obj2' type="pattern" url="https://marcheprime.github.io/lib/data/letterA.patt" registerevents>      
		<a-plane id='obj2fondtri' color="white" rotation="-90 0 0" position="0 -0.25 0" width="3" material="transparent: true; opacity: 0.90" visible='true'></a-plane>
		<a-text id='obj2txttri' value="Je suis ici\n pour rien !" font="https://marcheprime.github.io/lib/fonts/Exo2Bold.fnt" color="red" rotation="-90 0 0" align="center" scale="1 1 1" visible='true'></a-text>
    </a-marker>
	
	<a-marker id='obj3' type="pattern" url="https://marcheprime.github.io/lib/data/letterB.patt" registerevents>      
		<a-plane id='obj3fondtri' color="white" rotation="-90 0 0" position="0 -0.25 0" width="3" material="transparent: true; opacity: 0.90" visible='true'></a-plane>
		<a-text id='obj3txttri' value="Je suis ici\n pour rien !" font="https://marcheprime.github.io/lib/fonts/Exo2Bold.fnt" color="red" rotation="-90 0 0" align="center" scale="1 1 1" visible='true'></a-text>
    </a-marker>
	
	<a-marker id='obj4' type="pattern" url="https://marcheprime.github.io/lib/data/kanji.patt" registerevents>      
		<a-plane id='obj4fondtri' color="white" rotation="-90 0 0" position="0 -0.25 0" width="3" material="transparent: true; opacity: 0.90" visible='true'></a-plane>
		<a-text id='obj4txttri' value="Je suis ici\n pour rien !" font="https://marcheprime.github.io/lib/fonts/Exo2Bold.fnt" color="red" rotation="-90 0 0" align="center" scale="1 1 1" visible='true'></a-text>
    </a-marker>
	
	<a-marker id='obj5' type="barcode" value="0" registerevents>      
		<a-plane id='obj5fondtri' color="white" rotation="-90 0 0" position="0 -0.25 0" width="3" material="transparent: true; opacity: 0.90" visible='true'></a-plane>
		<a-text id='obj5txttri' value="Je suis ici\n pour rien !" font="https://marcheprime.github.io/lib/fonts/Exo2Bold.fnt" color="red" rotation="-90 0 0" align="center" scale="1 1 1" visible='true'></a-text>
    </a-marker>
	
    <a-entity id='s2' sound="src: #sound2; poolSize: 1;" autoplay="false"></a-entity>
	<a-entity id='s3' sound="src: #sound3; poolSize: 1;" autoplay="false"></a-entity>

	<a-entity camera></a-entity>

	</a-scene>  
</body>
